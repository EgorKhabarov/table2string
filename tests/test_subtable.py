from table2string import Table, Themes


def test_subtable():
    assert (
        Table(
            [
                map(
                    lambda t: t.stringify(theme=Themes.thin, align="^"),
                    (
                        Table([("1",), (Table([("2", "3")]),)]),
                        Table([(Table([("2", "3")]),), ("1",)]),
                        Table([("1",), (Table([("2",), ("3",)]),)]),
                        Table([(Table([("2",), ("3",)]),), ("1",)]),
                        Table([("1", Table([("2", "3")]))]),
                        Table([(Table([("2", "3")]), "1")]),
                        Table([("1", Table([("2",), ("3",)]))]),
                        Table([(Table([("2",), ("3",)]), "1")]),
                    ),
                ),
                (
                    Table([("1",), (Table([("2", "3")]),)]),
                    Table([(Table([("2", "3")]),), ("1",)]),
                    Table([("1",), (Table([("2",), ("3",)]),)]),
                    Table([(Table([("2",), ("3",)]),), ("1",)]),
                    Table([("1", Table([("2", "3")]))]),
                    Table([(Table([("2", "3")]), "1")]),
                    Table([("1", Table([("2",), ("3",)]))]),
                    Table([(Table([("2",), ("3",)]), "1")]),
                ),
            ]
        ).stringify(theme=Themes.thin_thick, align="^")
        == """
┌───────────┬───────────┬───────┬───────┬───────────────┬───────────────┬───────────┬───────────┐
│ ┌───────┐ │ ┌───┬───┐ │ ┌───┐ │ ┌───┐ │ ┌───┬───┬───┐ │ ┌───┬───┬───┐ │ ┌───┬───┐ │ ┌───┬───┐ │
│ │   1   │ │ │ 2 │ 3 │ │ │ 1 │ │ │ 2 │ │ │ 1 │ 2 │ 3 │ │ │ 2 │ 3 │ 1 │ │ │ 1 │ 2 │ │ │ 2 │ 1 │ │
│ ├───┬───┤ │ ├───┴───┤ │ ├───┤ │ ├───┤ │ └───┴───┴───┘ │ └───┴───┴───┘ │ │   ├───┤ │ ├───┤   │ │
│ │ 2 │ 3 │ │ │   1   │ │ │ 2 │ │ │ 3 │ │               │               │ │   │ 3 │ │ │ 3 │   │ │
│ └───┴───┘ │ └───────┘ │ ├───┤ │ ├───┤ │               │               │ └───┴───┘ │ └───┴───┘ │
│           │           │ │ 3 │ │ │ 1 │ │               │               │           │           │
│           │           │ └───┘ │ └───┘ │               │               │           │           │
┝━━━━━━━━━━━┿━━━━━┯━━━━━┿━━━━━━━┿━━━━━━━┿━━━━┯━━━━┯━━━━━┿━━━━┯━━━━━┯━━━━┿━━━━━┯━━━━━┿━━━━━┯━━━━━┥
│     1     │  2  │  3  │   1   │   2   │ 1  │ 2  │  3  │ 2  │  3  │ 1  │  1  │  2  │  2  │  1  │
├─────┬─────┼─────┴─────┼───────┼───────┤    │    │     │    │     │    │     ├─────┼─────┤     │
│  2  │  3  │     1     │   2   │   3   │    │    │     │    │     │    │     │  3  │  3  │     │
│     │     │           ├───────┼───────┤    │    │     │    │     │    │     │     │     │     │
│     │     │           │   3   │   1   │    │    │     │    │     │    │     │     │     │     │
└─────┴─────┴───────────┴───────┴───────┴────┴────┴─────┴────┴─────┴────┴─────┴─────┴─────┴─────┘
""".strip()
    )
    assert (
        Table(
            [
                (
                    "111111",
                    Table(
                        [
                            (
                                "2",
                                Table(
                                    [
                                        (
                                            Table(
                                                [
                                                    ("33333333333333333333", "4"),
                                                    (
                                                        Table(
                                                            [
                                                                ("55", "666"),
                                                                ("777", "8888"),
                                                            ]
                                                        ),
                                                        "9",
                                                    ),
                                                ]
                                            ),
                                            "0",
                                        ),
                                        ("10101010", "1"),
                                    ]
                                ),
                            ),
                            (
                                "2",
                                "13131313131313",
                            ),
                        ]
                    ),
                )
            ]
        ).stringify(theme=Themes.thin_thick, align="^")
        == """
┌────────┬───┬──────────────────────┬───┬───┐
│ 111111 │ 2 │ 33333333333333333333 │ 4 │ 0 │
│        │   ├─────────┬────────────┼───┤   │
│        │   │   55    │    666     │ 9 │   │
│        │   ├─────────┼────────────┤   │   │
│        │   │   777   │    8888    │   │   │
│        │   ├─────────┴────────────┴───┼───┤
│        │   │         10101010         │ 1 │
│        ├───┼──────────────────────────┴───┤
│        │ 2 │        13131313131313        │
└────────┴───┴──────────────────────────────┘
""".strip()
    )
    assert (
        Table(
            [
                ("1",),
                (
                    Table(
                        [
                            (
                                "2",
                                Table(
                                    [
                                        (Table([("5", "4")]),),
                                        ("3",),
                                    ]
                                ),
                            )
                        ]
                    ),
                ),
            ]
        ).stringify(theme=Themes.thin_thick, align="^")
        == """
┌───────────┐
│     1     │
┝━━━┯━━━┯━━━┥
│ 2 │ 5 │ 4 │
│   ├───┴───┤
│   │   3   │
└───┴───────┘
""".strip()
    )
    assert (
        Table(
            [
                ("1",),
                (
                    Table(
                        [
                            (
                                "2",
                                Table(
                                    [
                                        (Table([("5", "4")]),),
                                        ("3",),
                                    ]
                                ),
                            )
                        ]
                    ),
                ),
            ]
        ).stringify(theme=Themes.thin_thick, align="^", max_width=50)
        == """
┌────────────────────────────────────────────────┐
│                       1                        │
┝━━━━━━━━━┯━━━━━━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━━━━━┥
│    2    │        5         │         4         │
│         ├──────────────────┴───────────────────┤
│         │                  3                   │
└─────────┴──────────────────────────────────────┘
""".strip()
    )
